---
export const prerender = false
import Candidate from '../../components/Candidate.astro'
import Layout from '../../layouts/Layout.astro'
import Arrow from '../../components/icons/Arrow.astro'
import Colors from '../../enums/colors'
import { GET } from '../api/category/[categoryUrl]'

const response = await GET(Astro)
const category: Category = await response.json()

const title = category.name

const candidates = category.videos

const prev = category.prev?.url
const next = category.next?.url
---

<style>
  .candidate:hover .image {
    transform: scale(1.2);
  }
  .candidate:hover .overlay-pink {
    display: flex;
    background: rgba(255, 102, 148, 0.4);
    backdrop-filter: blur(2px) contrast(1.5);
  }
</style>

<Layout
  title={title}
  description='Votaciones'
  background='bg-gradient-to-r from-[#05303A] to-black-pearl'
  headerProps={{
    bgColor: 'bg-transparent',
    textColor: 'text-cotton-candy',
    showLogin: true,
    buttonsStyle: Colors.CottonCandy,
    routes: [
      { route: '/', name: 'Inicio' },
      { route: '/categorias', name: 'Categorias' }
    ]
  }}
>
  <!-- Peepo background -->
  <div
    class="flex min-h-[90svh] bg-[url('/Prayge.svg')] bg-[_80%_80%] bg-bottom bg-no-repeat"
  >
    <!-- FORMULARIO DE VOTACION -->
    <div class='flex w-screen flex-1 flex-col justify-around'>
      <!-- TITULO DE CATEGORIA -->
      <div class='flex justify-center'>
        <h1 class=`text-[4rem] font-semibold text-cotton-candy tracking-wide`>
          {title}
        </h1>
      </div>
      <!-- CANDIDATOS -->
      <div class='flex flex-wrap justify-center gap-8'>
        {
          candidates?.map(({ title, thumbnail_url }) => (
            <div class='candidate relative h-52 w-72 overflow-hidden bg-slate-600 outline-2 outline-offset-4 outline-cotton-candy-400 hover:outline'>
              <div
                style={`background-image: url(${thumbnail_url})`}
                class='image left-0 top-0 h-full w-full bg-cover bg-no-repeat'
              />
              <div class='overlay-pink absolute left-0 top-0 hidden h-full w-full cursor-pointer items-center justify-center bg-neutral-900 text-4xl text-white'>
                <div class='flex h-full w-full items-center justify-center bg-black bg-opacity-60'>
                  {title}
                </div>
              </div>
            </div>
          ))
        }
      </div>

      <!-- BOTONES DE NAVEGACION Y CONFIRMACION -->
      <div class='flex justify-between sm:px-28'>
        <!-- BOTON PREV -->
        {
          prev && (
            <a href={prev} class={`px-5 text-[1.75rem] text-glacier-100`}>
              <div class='w-14'>
                <Arrow />
                Anterior
              </div>
            </a>
          )
        }

        <!-- BOTON VOTAR -->
        <button
          type='button'
          value='Votar'
          class=`cursor-pointer bg-cotton-candy
              from-cotton-candy to-cotton-candy-400 px-16 max-h-16 font-bold tracking-wide
              shadow-[-10px_10px_black,-10px_10px_0_2px_rgb(255,184,208)]
              transition-all hover:-translate-x-5 hover:translate-y-2
              hover:shadow-none hover:transition-all text-[2rem]`
          >Votar</button
        >
        <!-- BOTON SIG -->
        {
          next && (
            <a
              href={next}
              class={`px-5 text-center text-[1.75rem] text-glacier-100`}
            >
              <div class='w-14'>
                <Arrow direction='right' />
                Siguiente
              </div>
            </a>
          )
        }
      </div>
    </div>
  </div>
</Layout>
